<?xml version="1.0" encoding="windows-1252" ?>
<!DOCTYPE ViewObject SYSTEM "jbo_03_01.dtd">
<!---->
<ViewObject
  xmlns="http://xmlns.oracle.com/bc4j"
  Name="FillBPOVO"
  Version="11.1.1.62.29"
  InheritPersonalization="true"
  BindingStyle="OracleName"
  CustomQuery="true"
  ComponentClass="mnj.ont.model.popup.FillBPOVOImpl"
  PageIterMode="Full"
  UseGlueCode="false">
  <DesignTime>
    <Attr Name="_codeGenFlag2" Value="Access|Coll|Prog|VarAccess"/>
    <Attr Name="_isExpertMode" Value="true"/>
  </DesignTime>
  <Properties>
    <SchemaBasedProperties>
      <LABEL
        ResId="mnj.ont.model.popup.FillBPOVO_LABEL"/>
    </SchemaBasedProperties>
  </Properties>
  <Variable
    Name="P_ORG_ID"
    Kind="where"
    Type="java.lang.String">
    <TransientExpression><![CDATA[adf.context.sessionScope.OrgID]]></TransientExpression>
  </Variable>
  <SQLQuery>
    <![CDATA[SELECT 
PO_NUMBER,
CURRENCY_CODE,
PO_DATE,
ORG_ID,
PAYMENT_TERMS,
SHIP_MODE,
BUYER_ID,
(  SELECT CUSTOMER_NAME FROM AR_CUSTOMERS AC WHERE AC.CUSTOMER_NAME_PHONETIC IN ('UM', 'EM') AND AC.STATUS = 'A'  AND  AC.CUSTOMER_ID = 
 BUYER_ID) BUYER ,
SEASON,
SUPPLIER,
VENDOR_ID,
SUM(NVL(PO_VALUE,0)) PO_VALUE

FROM
(



SELECT DISTINCT PLA.PO_LINE_ID ,   PHA.SEGMENT1 PO_NUMBER, PHA.CURRENCY_CODE,
       TRUNC (PHA.CREATION_DATE) PO_DATE,
        PHA.ORG_ID, 
          SUM (ROUND((PLA.UNIT_PRICE * PDA.QUANTITY_ORDERED),2)) PO_VALUE,
         NVL(PHA.ATTRIBUTE5,'-') PAYMENT_TERMS, 
          NVL(PHA.ATTRIBUTE6,'-') SHIP_MODE, 
                 
--        CASE WHEN  APPS.PO_LINE_POC_ID_F(PLA.PO_LINE_ID) = 'Sample ~ All'  
--             THEN     APPS.POC_ID_FOR_STYLE_SEASON_F( APPS.PO_LINE_SEASON_F(PLA.PO_LINE_ID), APPS.PO_LINE_STYLE_F(PLA.PO_LINE_ID) )
--             ELSE  ( SELECT   H.BUYER_ID FROM XX_OM_POC_H_T H  WHERE TO_CHAR(POC_ID) =  APPS.PO_LINE_POC_ID_F(PLA.PO_LINE_ID)) END
--        BUYER_ID ,

           (SELECT   H.BUYER_ID FROM XX_OM_POC_H_T H  WHERE TO_CHAR(POC_ID) =  APPS.PO_LINE_POC_ID_F(PLA.PO_LINE_ID)) BUYER_ID ,
            
        APPS.PO_LINE_SEASON_F(PLA.PO_LINE_ID) SEASON,
                      
      --  APPS.PO_LINE_STYLE_F(PLA.PO_LINE_ID) STYLE,
         
       PLA.VENDOR_PRODUCT_NUM  STYLE_SEASON    , 

        (SELECT PV.VENDOR_NAME FROM PO_VENDORS PV WHERE PV.VENDOR_ID = PHA.VENDOR_ID) SUPPLIER,
         PHA.VENDOR_ID
    FROM 
         PO_HEADERS_ALL PHA, 
         PO_LINES_ALL PLA,
         PO_DISTRIBUTIONS_ALL PDA,
         
         MNJ_REQUISITION_BOM_V MRB
   WHERE 
         PHA.PO_HEADER_ID = PLA.PO_HEADER_ID
     AND PDA.PO_HEADER_ID = PHA.PO_HEADER_ID
     AND PDA.PO_LINE_ID   = PLA.PO_LINE_ID
     
     AND PHA.TYPE_LOOKUP_CODE = 'STANDARD'
     --mt
     AND PDA.REQ_DISTRIBUTION_ID = MRB.DISTRIBUTION_ID(+)
    AND PHA.ORG_ID=:P_ORG_ID
    AND PDA.GL_CANCELLED_DATE IS NULL
    AND PLA.CANCEL_FLAG='N' 
    AND PHA.APPROVED_FLAG = 'Y' --added on 17.08.18
     AND NOT EXISTS (SELECT 1 FROM IEDOC_IMP_PI_DETAILS IIPD,IEDOC_IMP_PI_LINES IIPL 
                             WHERE IIPD.IMP_PI_LINE_ID = IIPL.IMP_PI_LINE_ID  
                               AND IIPD.PO_NO = PHA.SEGMENT1 
                               AND IIPL.ORG_ID = PHA.ORG_ID 
                               AND IIPL.ORG_ID=:P_ORG_ID
                                )                   
   GROUP BY PHA.SEGMENT1, 
         TRUNC (PHA.CREATION_DATE), 
         PHA.ORG_ID,
         PHA.VENDOR_ID,
         MRB.BUYER_ID,
         MRB.SEASON_C,
        -- MRB.STYLE_NAME_C,
        -- MRB.STYLE_NO_C,
         PHA.ATTRIBUTE6 ,
         PHA.ATTRIBUTE5,
         MRB.BOM_ID,
         PHA.CURRENCY_CODE,
         PLA.PO_HEADER_ID ,
         PLA.PO_LINE_ID ,
         PLA.VENDOR_PRODUCT_NUM  )
         
GROUP BY PO_NUMBER,
CURRENCY_CODE,
PO_DATE,
ORG_ID,
PAYMENT_TERMS,
SHIP_MODE,
BUYER_ID,
SEASON,
SUPPLIER,
VENDOR_ID]]>
  </SQLQuery>
  <ViewAttribute
    Name="PoNumber"
    IsUpdateable="false"
    IsPersistent="false"
    IsNotNull="true"
    PrecisionRule="true"
    Precision="255"
    Type="java.lang.String"
    ColumnType="VARCHAR2"
    AliasName="PO_NUMBER"
    Expression="PO_NUMBER"
    SQLType="VARCHAR">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="20"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="CurrencyCode"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Precision="15"
    Type="java.lang.String"
    ColumnType="VARCHAR2"
    AliasName="CURRENCY_CODE"
    Expression="CURRENCY_CODE"
    SQLType="VARCHAR">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="15"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="PoDate"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Type="oracle.jbo.domain.Date"
    ColumnType="DATE"
    AliasName="PO_DATE"
    Expression="PO_DATE"
    SQLType="DATE">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="7"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="OrgId"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Type="oracle.jbo.domain.Number"
    ColumnType="NUMBER"
    AliasName="ORG_ID"
    Expression="ORG_ID"
    SQLType="NUMERIC">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="39"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="PaymentTerms"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Precision="8"
    Type="java.lang.String"
    ColumnType="CHAR"
    AliasName="PAYMENT_TERMS"
    Expression="PAYMENT_TERMS"
    SQLType="VARCHAR">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="8"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="ShipMode"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Precision="9"
    Type="java.lang.String"
    ColumnType="CHAR"
    AliasName="SHIP_MODE"
    Expression="SHIP_MODE"
    SQLType="VARCHAR">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="9"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="BuyerId"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Type="oracle.jbo.domain.Number"
    ColumnType="NUMBER"
    AliasName="BUYER_ID"
    Expression="BUYER_ID"
    SQLType="NUMERIC">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="39"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="Buyer"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Precision="5"
    Type="java.lang.String"
    ColumnType="CHAR"
    AliasName="BUYER"
    Expression="BUYER"
    SQLType="VARCHAR">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="5"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="Season"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Precision="6"
    Type="java.lang.String"
    ColumnType="CHAR"
    AliasName="SEASON"
    Expression="SEASON"
    SQLType="VARCHAR">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="6"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="Supplier"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Precision="8"
    Type="java.lang.String"
    ColumnType="CHAR"
    AliasName="SUPPLIER"
    Expression="SUPPLIER"
    SQLType="VARCHAR">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="8"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="VendorId"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Type="oracle.jbo.domain.Number"
    ColumnType="NUMBER"
    AliasName="VENDOR_ID"
    Expression="VENDOR_ID"
    SQLType="NUMERIC">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="39"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="PoValue"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Type="oracle.jbo.domain.Number"
    ColumnType="NUMBER"
    AliasName="PO_VALUE"
    Expression="PO_VALUE"
    SQLType="NUMERIC">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="39"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="StyleName"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Precision="10"
    Type="java.lang.String"
    ColumnType="CHAR"
    AliasName="STYLE_NAME"
    SQLType="VARCHAR">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="10"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="StyleNumber"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Precision="12"
    Type="java.lang.String"
    ColumnType="CHAR"
    AliasName="STYLE_NUMBER"
    SQLType="VARCHAR">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="12"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="BpoNumber"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Precision="10"
    Type="java.lang.String"
    ColumnType="CHAR"
    AliasName="BPO_NUMBER"
    SQLType="VARCHAR">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="10"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="Buyername"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Precision="50"
    Type="java.lang.String"
    ColumnType="VARCHAR2"
    AliasName="BUYERNAME"
    SQLType="VARCHAR">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="50"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="StyleSeason"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Precision="25"
    Type="java.lang.String"
    ColumnType="VARCHAR2"
    AliasName="STYLE_SEASON"
    SQLType="VARCHAR">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="25"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="Item"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Precision="245"
    Type="java.lang.String"
    ColumnType="VARCHAR2"
    AliasName="ITEM"
    SQLType="VARCHAR">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="245"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="ItemDescription"
    IsUpdateable="false"
    IsPersistent="false"
    PrecisionRule="true"
    Precision="240"
    Type="java.lang.String"
    ColumnType="VARCHAR2"
    AliasName="ITEM_DESCRIPTION"
    SQLType="VARCHAR">
    <DesignTime>
      <Attr Name="_DisplaySize" Value="240"/>
    </DesignTime>
  </ViewAttribute>
  <ViewAttribute
    Name="CheckBoxBPO"
    IsSelected="false"
    IsPersistent="false"
    PrecisionRule="true"
    Type="java.lang.Boolean"
    ColumnType="NUMBER"
    AliasName="VIEW_ATTR"
    SQLType="BIT">
    <Properties>
      <SchemaBasedProperties>
        <CONTROLTYPE
          Value="check_box"/>
      </SchemaBasedProperties>
    </Properties>
  </ViewAttribute>
  <ResourceBundle>
    <PropertiesBundle
      PropertiesFile="model.ModelBundle"/>
  </ResourceBundle>
</ViewObject>
